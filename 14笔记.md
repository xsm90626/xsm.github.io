## 数据库优化
* 硬件  > 钱
* 网络  > 钱
* 软件
    > 表设计
        1. 符合数据库设计三范式。范式：数据库设计的规则
            数据减少冗余(重复)

        2. 字段类型选择
            报小不报大。 

            特殊：ip地址、手机号码、用户状态

        3. 合理添加索引

        4. 尽量给每个字段添加not null


    > 字符集选择
      utf8   gbk   一般选择 utf8  


    > 表引擎选择
        InnoDb与MyISAM区别
                1. 事务支持
                     InnoDb支持事务。

                2. 锁机制不一样
                    InnoDb支持行锁、也有表锁。
                    MyISAM只有表锁。
                    表锁：锁的整个表。 
                    行锁：锁上对应行。


                    myisam读锁特点：不会阻塞读、只会阻塞写操作

                    myisam写锁特点：会阻塞读与写。

                    当mysaim表发生写锁的时候，只有当写锁被释放的时候，
                    我们才可以对myisam表进行读/写操作


                如果一个项目写操作比较多，应该选择innodb



                    myisam正在写的时候，会发生表锁。
                        我们不能读/写



                3. 查询速度

                    小型项目在使用myisam引擎，查询速度相对快一点。
                    mysql5.6之后，innodb与myisam查询速度是差不多。
                    oracel已经不对myisam维护了。
                    所以建议选择innodb

                4. 文件存放方式不一样
                    myisam有三个文件：.MYD(存放数据) 

                        .MYI(存放索引)  .FRM(表结构)


                    innodb默认情况下索引与数据存放到一个文件。





    > SQL语句与索引优化
            优化SQL  =》 找到需要优化的SQL语句

            => 开启慢查询   => 优化找到SQL语句


            => 使用索引( 索引是最有效的优化手段 )


            =>查询速度


    > 索引的使用

        给哪些字段添加索引：
            1. 给经常作为where条件的字段添加索引

                select * from t3 where name = 'jack' 



                and email

                ='jack@qq.com';


            2. order by 和group by的字段也要添加索引








    > MySQL配置文件优化

    > 体系架构
        MySQL主从

        MySQL分布式



## 数据冗余的例子


    user
        id  name  pwd        email
         1  jack   fdsjk     jack@qq.com


    分数表
        id(自增)      uid    score(分数)    subject
          1             1     100              数学
          2              1      90              语文




订单表( 卖娃娃 )
订单：显示商品。  适度数据冗余。提高查询速度， 缺点：数据冗余
，占用磁盘大小、

order 
id  gid     gname  数量     uid
 1    1      娃娃



goods(商品)
id  gname
1    娃娃1

user

id  uname   uphone(用户手机)   



# 联合索引

   ALTER  TABLE t4 ADD INDEX in_index(name,email)




## SQL语句如何优化

1. 合理使用索引，避免使用不到的索引，不要给类型比较大的字段添加索引


2. 不要使用子查询，可以使用join替换子查询

    left join 



3. 不要使用*号，只查需要的字段。

4. limit分页优化

5. 多使用limit
   

6. 可以使用冗余来减少关联表查询。以空间换时间。

7、尽量不要在数据库中做运算

8. 减少使用MySQL内置函数

9. 最先出现的条件，一定是过滤和排除掉更多结果的条件，第二出现的次
之。
    

    select * from user where name = 'jack' and  sex = '1'//应该选择这个

    select * from user where  sex = '1' and   name = 'jack'



    







    user (用户)
        id   name     pwd  email  status  logintime  sex 
         1    jack 
         2    mary



## 左连接的语法

    //会将user表的全部数据查询出来
    select name,pwd,address from user left join user_detail 

    on  user.id = user_detail.uid;



## 配置文件优化

    这个事情一般是DBA做的。我们不做。

    我们非要做的。参考百度上面一些配置。












